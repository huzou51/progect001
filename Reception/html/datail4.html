<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>夕阳红-商品详情-介绍</title>
	<link rel="stylesheet" type="text/css" href="../css/reset.css">
	<link rel="stylesheet" type="text/css" href="../css/main.css">
	<script src="../js/jquery-1.11.1/jquery.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
	<div class="header_con">
		<div class="header">
			<div class="welcome fl">欢迎来到夕阳红!</div>
			<div class="fr">
				<div class="login_info fl">
					<em id="uname"></em>
				</div>
				<div class="login_btn fl">
					<a href="login.html" >登录</a>
					<span>|</span>
					<a href="register.html">注册</a>
				</div>
				<div class="user_link fl">
					<span>|</span>
					<a href="user_center_info.html">用户中心</a>
					<span>|</span>
					<a href="cart.html">我的购物车</a>
					<span>|</span>
					<a href="user_center_order.html">我的订单</a>
				</div>
			</div>
		</div>		
	</div>

	<div class="search_bar clearfix">
		<a href="../index.html" class="logo fl"><img src="../img/logo.png"></a>
		<div class="search_con fl">
			<input type="text" class="input_text fl" name="" placeholder="搜索商品">
			<input type="button" class="input_btn fr" name="" value="搜索">
		</div>
		<div class="guest_cart fr">
			<a href="cart.html" class="cart_name fl">我的购物车</a>
			<div class="goods_count fl" id="show_count">0</div>
		</div>
	</div>

	<div class="navbar_con">
		<div class="navbar clearfix">
			<div class="subnav_con fl">
				<h1>全部商品分类</h1>	
				<span></span>			
				<ul class="subnav">
					<li><a href="#model01" class="fruit">休闲零食</a></li>
					<li><a href="#model02" class="seafood">粮油米面</a></li>
					<li><a href="#model03" class="meet">乳饮酒水</a></li>
					<li><a href="#model04" class="egg">日常百货</a></li>
					<li><a href="#model05" class="vegetables">生鲜水果</a></li>
					<li><a href="#model06" class="ice">速冻食品</a></li>
				</ul>
			</div>
			<ul class="navlist fl">
				<li><a href="index.html">首页</a></li>
				<li class="interval">|</li>
				<li><a href="">今日疯抢</a></li>
				<li class="interval">|</li>
				<li><a href="">限时促销</a></li>
				<li class="interval">|</li>
				<li><a href="">精品推荐</a></li>
				<li class="interval">|</li>
			</ul>
		</div>
	</div>

	<div class="breadcrumb">
		<a href="#">全部分类</a>
		<span>></span>
		<a href="#">新鲜水果</a>
		<span>></span>
		<a href="#">商品详情</a>
	</div>

	<div class="goods_detail_con clearfix">
		<div class="all box" id="box">
			<div class="goods_detail_pic fl small" id="smallBox">
				<img src="" id="smallPic">
				<div id="mask" class="mask"></div>
			</div>
			<div class="goods_detail_pic fl big" id="bigBox">
				<img src=""  id="bigPic">
			</div>
			<div class=""></div>
		</div>

		<div class="goods_detail_list fr">
			<h3 id="dataName">大兴大棚草莓</h3>
			<!-- <p>草莓浆果柔软多汁，味美爽口，适合速冻保鲜贮藏。草莓速冻后，可以保持原有的色、香、味，既便于贮藏，又便于外销。</p> -->
			<div class="prize_bar" style="margin-top: 20px;">
				<span class="show_pirze" id="dataPrice"></span>
				<span class="show_pro">累计销量：<em>398件</em></span>
				<span class="show_address"><a href="user_center_site.html">设置收货地址</a></span>
				<span class="show_pass">运费：包邮</span>
			</div>
			<div class="goods_num clearfix">
				<div class="num_name fl">数 量：</div>
				<div class="num_add fl">
					<input type="text" class="num_show fl" value="1" id="ipt_num">
					<a href="javascript:;" class="add fr">+</a>
					<a href="javascript:;" class="minus fr">-</a>	
				</div> 
			</div>
			<div class="total">总价：<em id="dataPrice2"></em></div>
			<div class="operate_btn">
				<a href="place_order.html" class="buy_btn">立即购买</a>
				<a href="javascript:;" class="add_cart" id="add_cart">加入购物车</a>				
			</div>
		</div>
	</div>

	<div class="footer">
		<div class="footer_ban">
			<img src="../img/index/footer-1.png" width="80%" height="100px">
		</div>
		<div class="footer_ul">
			<ul>
				<li><a href="">购物指南</a></li>
				<li><a href="">购物流程</a></li>
				<li><a href="">会员介绍</a></li>
				<li><a href="">生活旅行/团购</a></li>
				<li><a href="">常见问题</a></li>
				<li><a href="">联系客服</a></li>
			</ul>
			<ul>
				<li><a href="">配送方式</a></li>
				<li><a href="">上门自提</a></li>
				<li><a href="">飞毛腿服务</a></li>
				<li><a href="">配送服务查询</a></li>
				<li><a href="">配送费收取标准</a></li>
				<li><a href="">海外配送</a></li>
			</ul>
			<ul>
				<li><a href="">支付方式</a></li>
				<li><a href="">货到付款</a></li>
				<li><a href="">在线支付</a></li>
				<li><a href="">分期付款</a></li>
				<li><a href="">公司转账</a></li>
			</ul>
			<ul>
				<li><a href="">售后服务</a></li>
				<li><a href="">售后政策</a></li>
				<li><a href="">价格保护</a></li>
				<li><a href="">退款说明</a></li>
				<li><a href="">取消订单</a></li>
				<li><a href="">返修/退换货</a></li>
			</ul>
			<ul>
				<li><a href="">特色服务</a></li>
				<li><a href="">延保服务</a></li>
				<li><a href="">DIY服务</a></li>
				<li><a href="">夕阳红活动</a></li>
				<li><a href="">低价活动</a></li>
			</ul>
		</div>
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">合作招商</a>
			<span>|</span>
			<a href="#">夕阳红社区</a>	
			<span>|</span>
			<a href="#">隐私政策</a>	
			<span>|</span>
			<a href="#">商家帮助</a>	
			<span>|</span>
			<a href="#">风险监测</a>	
		</div>
		<p>CopyRight © 2020 成都夕阳红网上超市 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>
	<div class="add_jump"></div>

	<script type="text/javascript" src="js/jquery-1.11.1/jquery.js"></script>
	<script type="text/javascript" src="./js/jquery-1.8.3/jquery.min.js"></script>
	
	<!--图片放大 -->
	<script type="text/javascript">
		var smallBox = document.getElementById('smallBox');
		var mask = document.getElementById('mask');
		var bigBox = document.getElementById('bigBox');
		var box = document.getElementById('box')
		var bigPic = document.getElementById('bigPic')
		//鼠标经过小盒子，显示大盒子
		smallBox.onmouseover = function() {
		    bigBox.style.display = "block";
		    mask.style.display = "block";
		
		}
		
		smallBox.onmouseout = function() {
		    bigBox.style.display = "none";
		    mask.style.display = "none";
		}
		smallBox.onmousemove = function(event) {
		    //遮罩跟随鼠标
		    var event = event || widow.event;
		    var pageX = event.pageX || event.clientX + document.documentElement.scrollLeft;
		    var pageY = event.pageY || event.clientY + document.documentElement.scrollTop;
		    //计算mask的位置
		    // var boxX = ;
		    // var boxY =  ;
		    var targetX = pageX - box.offsetLeft - mask.offsetWidth / 2;
		    var targetY = pageY - box.offsetLeft - mask.offsetHeight / 2;
		    //限制mask移动范围
		    if (targetX < 0) {
		        targetX = 0;
		    }
		    // if(targetX > 175){
		    // 	targetX = 175;
		    // }
		    if (targetY < 0) {
		        targetY = 0;
		    }
		    // if(targetY > 175){
		    // 	targetY = 175;
		    // }
		
		    if (targetX > smallBox.offsetWidth - mask.offsetWidth) {
		        targetX = smallBox.offsetWidth - mask.offsetWidth;
		    }
		
		    if (targetY > smallBox.offsetHeight - mask.offsetHeight) {
		        targetY = smallBox.offsetHeight - mask.offsetHeight;
		    }
		    //console.log(smallBox.offsetWidth-mask.offsetWidth);
		    // console.log(mask.offsetWidth);
		    //console.log(targetX);
		    mask.style.left = targetX + "px";
		    mask.style.top = targetY + "px";
		    //按照比例移动大图
		    var bigToMove = bigPic.offsetWidth - bigBox.offsetWidth;
		    var maskToMove = smallBox.offsetWidth - mask.offsetWidth;
		    var rate = bigToMove / maskToMove;
		    bigPic.style.left = -rate * targetX + "px";
		    bigPic.style.top = -rate * targetY + "px";
		}
	</script>
	
	
	<!-- 计算价格和数量 -->
	<script src="js/jquery-1.12.4.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery-1.8.3/jquery.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery-1.11.1/jquery.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		$(function(){
			//3.更改商品数量-
			$(".add").click(function(){
				var n = $(this).siblings(".num_show").val();
				var that = this;
				n++;
				$(this).siblings(".num_show").val(n);

				//获取到单价---点击小计改变（---）
				var p = $(this).parent().parent().siblings(".prize_bar").children(".show_pirze").html();
				var mm = p.substr(1);
				var price = (mm * n).toFixed(2);
				// console.log(price)
				// 单价乘以总数
				$(this).parent().parent().siblings(".total").children("em").html("￥"+price + '元');
				// // getSum();
			});
			$(".minus").click(function(){
				var n = $(this).siblings(".num_show").val();
				var that = this;
				if(n == 1){
					return false;
				}
				n--;
				$(this).siblings(".num_show").val(n);
				
				// 获取到单价---点击小计改变（---）
				var p = $(this).parent().parent().siblings(".prize_bar").children(".show_pirze").html();
				var mm = p.substr(1);
				var price = (mm * n).toFixed(2);
				//单价乘以总数
				$(this).parent().parent().siblings(".total").children("em").html("￥"+price + '元');
				// getSum();
			});
		})
		
	</script>
	
	
	
	
	
	
	
	<script type="text/javascript">
		var index;
		(function(){
			index = localStorage.getItem("index");
			console.log(index);
		})()
		var xmlhttp;
		if(window.XMLHttpRequest){
			xmlhttp = new XMLHttpRequest();
		}else{
			xmlhttp = new ActiveXObject("Microsoft.XMLHTTP")
		}
		xmlhttp.open("GET","http://127.0.0.1/Reception/interface/getdata.php")
		xmlhttp.send();
		xmlhttp.onreadystatechange=function(){
			if(xmlhttp.readyState == 4 &&xmlhttp.status ==200){
				//转化json对象
				var dataJson = JSON.parse(xmlhttp.responseText).data;
				var data = [];
				for(let i=0;i<dataJson.length;i++){
					if(dataJson[i].group==4){
						data.push(dataJson[i]);
					}
				}
				console.log(data);
				console.log(data[index]);
				$("#dataName").html(data[index].name);
				$("#dataPrice").html("￥"+data[index].price);
				$("#dataPrice2").html("￥"+data[index].price);
				var smallPic = document.getElementById("smallPic");
				var bigPic = document.getElementById("bigPic");
				var index_l = parseInt(index)+1;
				smallPic.src="../img/baihuo/"+index_l+".jpg";
				bigPic.src="../img/baihuo/"+index_l+".jpg";
			}
		}
		
		var show_count = document.getElementById("show_count"),
		add_cart = document.getElementById("add_cart"),
		add_cart_count=0;
		add_cart.onclick = function(){
			add_cart_count+=1;
			show_count.innerHTML = add_cart_count;
			ipt_num_func();

		}
		var ipt_num=0,dataPrice;
		function ipt_num_func(){
			 ipt_num =ipt_num + parseInt($(".add").siblings(".num_show").val());
			 dataPrice = parseFloat($("#dataPrice").html().substr(1));
			 var dataName = $("#dataName").html();
			 var smallPic = document.getElementById("smallPic");
			 var smallPic_src = smallPic.src;
			var obj = {
						ipt_num:ipt_num,
						dataName:dataName,
						dataPrice:dataPrice,
						smallPic_src:smallPic_src
			}
			obj = JSON.stringify(obj);
			localStorage.setItem("obj",obj);
		}
		
		
		
		
		
		$(function(){
			var name = localStorage.getItem("name");
			$("#uname").html("欢迎您："+name);
		})
	</script>
	
</body>
</html>